{% extends "base.html" %}

{% block hull %}


<div class="frontThird widget">
<h1>Nowe posty</h1>
    {% for post in posts %}
		<div class="post">
		  <div class="meta">
		    <span class="date">{{ post.date|date:"d.m.Y" }} - 
		  	<b><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></b>
		  	{% if post.more %}
		  	<img src="{{STATIC_URL}}/images/icons/roll.png" style="display: inline; width: 13px; height: 13px; border: 0; padding: 0; margin: 0; vertical-align: top;" align="center"/>
		  	{% endif %}
		  </div>
		
		  <div class="postContent">
		    {{ post.post|safe }}
		    
		    {% if post.more  %}
		    <div style="display: none;">
		    	{{ post.more|safe }}
		    </div>
		    {% endif %}
		  </div>
		</div>
		<br />
	{% endfor %}

</div>

<div class="frontThird widget">
	<h1>Nowe piosenki</h1>
	{% for song in songs %}
    	<li>
		    <span class="date">{{ song.0|date:"d.m.Y" }}</span>, 
		    <a href="{{song.1.get_absolute_url}}">{{ song.1|truncatechars:30 }}</a>
		</li>
	{% endfor %}
</div>

<div class="frontThird widget">
	<h1>NadchodzÄ…ce wydarzenia</h1>
	<ul>
    {% for event in events%}
    	<li>
		    <span class="date">{{ event.datetime|date:"d.m.Y" }}</span>,
		    <a href="{{event.get_absolute_url}}">{{ event.venue.town }}: {{ event.name }}</a>
		</li>
	{% endfor %}
	</ul>
	<br />

<script type="text/javascript">
//<![CDATA[
    var map_location;
    
    function savePosition_location(point)
    {
        var input = document.getElementById("id_location");
        input.value = point.lat().toFixed(6) + "," + point.lng().toFixed(6);
        map_location.panTo(point);
    }
    
    function load_location() {
        var point = new google.maps.LatLng(52.04, 19.28);

        var options = {
            zoom: 5,
            center: point,
            mapTypeId: google.maps.MapTypeId.ROADMAP
            // mapTypeControl: true,
            // navigationControl: true
        };
        
        map_location = new google.maps.Map(document.getElementById("map_location"), options);

        {% for event in events %}
        
            var marker_{{forloop.counter}} = new google.maps.Marker({
                    map: map_location,
                    position: new google.maps.LatLng({{event.venue.location_lat}}, {{event.venue.location_lng}}),
                    draggable: false,
                    url: '{{event.get_absolute_url}}',
                    title: '{{event}}'
            
            });
            
            google.maps.event.addListener(marker_{{forloop.counter}}, 'click', function() {
      window.location.href = marker_{{forloop.counter}}.url;
    });
        {% endfor %}

    }
    
    $(document).ready(function(){
        load_location();
    });

//]]>
</script>
<div id="map_location" style="width: 295px; height: 215px"></div>
<br />
</div>
	    
{% endblock hull %}